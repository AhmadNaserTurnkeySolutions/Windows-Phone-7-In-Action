<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=480, hight=768, user-scalable=no" />
    <link rel="stylesheet" href="Html5App.css" />
    <title>Windows Phone 7 in Action</title>
  </head>
  <body>
    <header>
      <hgroup>
        <h2>
          WINDOWS PHONE 7 IN ACTION
        </h2>
        <h1>
          html5 location
        </h1>
      </hgroup>
    </header>
    <section>
      <article id="greeting">
      </article>
      <article id="location">Looking for your location...</article>
      <article>
        <button type="button" class="wp7button" onclick="window.external.Notify('chooseAddress');">
          Choose an address
        </button>
      </article>
      <article id="address">
      </article>
    </section>
  </body>
  <script>
    function addressChooserCompleted(address) {
        document.getElementById('address').innerHTML = address;
    }

    function positionChanged(position) {
    var coords = position.coords;

    var message = 'Latitude: ' + coords.latitude + '<br/>';
    message += 'Longitude: ' + coords.longitude + '<br/>';
    message += ' ± ' + coords.accuracy + ' meters <br/><br/>';
    message += 'Altitude: ' + coords.altitude;
    message += ' ± ' + coords.altitudeAccuracy + ' meters <br/><br/>';
    message += 'Heading: ' + coords.heading + ' degrees from true north<br/>';
    message += 'Speed: ' + coords.speed + ' meters/second';

    document.getElementById('location').innerHTML = message;
    }

    function locationError(msg) {
    document.getElementById('location').innerHTML = msg;
    }

    // the following script is executed when the page is loaded
    var name = window.location.hash.split('=')[1];
    document.getElementById('greeting').innerHTML = 'Hello ' + name + '. ';

    if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(positionChanged, locationError, { enableHighAccuracy: true });
    } else {
    locationError('not supported');
    }
  </script>
</html>
